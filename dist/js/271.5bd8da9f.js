"use strict";(self["webpackChunkmy_vue3_project"]=self["webpackChunkmy_vue3_project"]||[]).push([[271],{982:function(e,a,t){t.r(a),t.d(a,{default:function(){return y}});var l=t(3396),o=t(9242);const i=(0,l.Uk)(" 商品分类 "),n={id:"mainbox"},s={class:"ordertab"},c={class:"goodslist"},u={class:"content"};function d(e,a,t,d,r,p){const v=(0,l.up)("nav-bar"),m=(0,l.up)("van-tab"),g=(0,l.up)("van-tabs"),h=(0,l.up)("van-sidebar-item"),_=(0,l.up)("van-collapse-item"),b=(0,l.up)("van-collapse"),f=(0,l.up)("van-sidebar"),k=(0,l.up)("van-card"),w=(0,l.up)("back-top");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[i])),_:1}),(0,l._)("div",n,[(0,l._)("div",s,[(0,l.Wm)(g,{active:d.act,"onUpdate:active":a[0]||(a[0]=e=>d.act=e),onClick:d.onClickTab},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{title:"销量排序"}),(0,l.Wm)(m,{title:"价格排序"}),(0,l.Wm)(m,{title:"评论排序"})])),_:1},8,["active","onClick"])]),(0,l.Wm)(f,{modelValue:d.active,"onUpdate:modelValue":a[2]||(a[2]=e=>d.active=e),class:"leftmenu"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{modelValue:d.activeName,"onUpdate:modelValue":a[1]||(a[1]=e=>d.activeName=e),accordion:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.categories,((e,a)=>((0,l.wg)(),(0,l.j4)(_,{key:"item.id",title:e.name,name:e.name},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.children,(e=>((0,l.wg)(),(0,l.j4)(h,{key:e.id,title:e.name,onClick:a=>d.getGoods(e.id)},null,8,["title","onClick"])))),128))])),_:2},1032,["title","name"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"]),(0,l._)("div",c,[(0,l._)("div",u,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.showGoods,(e=>((0,l.wg)(),(0,l.j4)(k,{num:e.comments_count,tag:e.comments_count>0?"热卖":"新品",price:e.price,desc:e.updated_at,title:e.title,thumb:e.cover_url,"lazy-load":!0,key:e.id,onClick:a=>d.itemClick(e.id)},null,8,["num","tag","price","desc","title","thumb","onClick"])))),128))])]),(0,l.wy)((0,l.Wm)(w,{onBTop:d.bTop},null,8,["onBTop"]),[[o.F8,d.isTabFixed]])])],64)}var r=t(920),p=t(4870),v=t(7707);function m(){return(0,v.W)({url:"/api/goods"})}function g(e="sales",a=0,t=1){return(0,v.W)({url:"/api/goods?category_id="+a+"&page="+t+"&"+e+"=1"})}var h=t(5031),_=t(7368),b=t(678),f={name:"Category",components:{NavBar:r.Z,BackTop:_.Z},setup(){let e=(0,p.iH)(0),a=(0,p.iH)([]),t=(0,p.iH)(1),o=(0,p.iH)(1),i=(0,p.iH)(0),n=(0,p.iH)("sales"),s=(0,p.qj)({}),c=(0,p.iH)(!1);const u=(0,b.tv)(),d=(0,p.qj)({sales:{page:1,list:[]},price:{page:1,list:[]},comments_count:{page:1,list:[]}}),r=(0,l.Fl)((()=>d[n.value].list)),v=()=>{g("sales",i.value).then((e=>{console.log(e),d.sales.list=e.data.goods.data})),g("price",i.value).then((e=>{d.price.list=e.data.goods.data})),g("comments_count",i.value).then((e=>{d.comments_count.list=e.data.goods.data}))};(0,l.bv)((()=>{m().then((e=>{a.value=e.data.categories})),v(),s=new h.ZP(document.querySelector(".goodslist"),{probeType:3,click:!0,pullUpLoad:!0}),s.on("scroll",(e=>{c.value=-e.y>300})),s.on("pullingUp",(()=>{console.log("上拉加载更多...");d[n.value].page;g(n.value,i.value).then((e=>{d[n.value].list.push(...e.data.goods.data),d[n.value].page+=1,s&&s.refresh()})),s.finishPullUp(),s.refresh()}))}));const _=e=>{let a=["sales","price","comments_count"];console.log("排序的序号："+a[e]),n.value=a[e],g(n.value,i.value).then((e=>{d[n.value].list=e.data.goods.data,s&&s.refresh()}))},f=e=>{i.value=e,console.log(i.value),g(n.value,i.value).then((e=>{d[n.value].list=e.data.goods.data})),s&&s.refresh()};(0,l.m0)((()=>{(0,l.Y3)((()=>{s&&s.refresh()}))}));const k=()=>{s.scrollTo(0,0,500)},w=e=>{u.push({path:"/detail",query:{id:e}})};return{active:e,categories:a,activeName:t,act:o,onClickTab:_,currentOrder:n,getGoods:f,currentId:i,goods:d,showGoods:r,init:v,bs:s,isTabFixed:c,bTop:k,itemClick:w}}},k=t(89);const w=(0,k.Z)(f,[["render",d],["__scopeId","data-v-318486f0"]]);var y=w}}]);
//# sourceMappingURL=271.5bd8da9f.js.map