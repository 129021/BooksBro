"use strict";(self["webpackChunkmy_vue3_project"]=self["webpackChunkmy_vue3_project"]||[]).push([[650],{771:function(t,e,n){n.d(e,{Fw:function(){return i},LV:function(){return l},LX:function(){return s},Nc:function(){return u},_r:function(){return r},dz:function(){return c},jo:function(){return a}});var o=n(7707);function l(t){return(0,o.W)({url:"/api/orders",method:"post",params:t})}function a(){return(0,o.W)({url:"/api/orders/preview",method:"get"})}function r(t,e){return(0,o.W)({url:`/api/orders/${t}/pay`,method:"get",params:e})}function s(t){return(0,o.W)({url:`/api/orders/${t}/status`,method:"get"})}function i(t){return(0,o.W)({url:"/api/orders",method:"get",params:t})}function c(t){return(0,o.W)({url:`/api/orders/${t}`,method:"get",params:{include:"orderDetails.goods,address,user"}})}function u(t){return(0,o.W)({url:`/api/orders/${t}/confirm`,method:"patch"})}},920:function(t,e,n){n.d(e,{Z:function(){return v}});var o=n(3396),l=n(2291);const a=t=>((0,o.dD)("data-v-22cb7b90"),t=t(),(0,o.Cn)(),t),r={class:"nav-bar"},s=a((()=>(0,o._)("img",{src:l,alt:""},null,-1))),i={class:"center"},c=(0,o.Uk)("default"),u={class:"right"};function d(t,e,n,l,a,d){return(0,o.wg)(),(0,o.iD)("div",r,[(0,o._)("div",{class:"left",onClick:e[0]||(e[0]=(...t)=>l.goback&&l.goback(...t))},[(0,o.WI)(t.$slots,"left",{},(()=>[s]),!0)]),(0,o._)("div",i,[(0,o.WI)(t.$slots,"default",{},(()=>[c]),!0)]),(0,o._)("div",u,[(0,o.WI)(t.$slots,"right",{},void 0,!0)])])}var m=n(678),f={name:"NavBar",setup(){const t=(0,m.tv)(),e=()=>{t.go(-1)};return{goback:e}}},g=n(89);const p=(0,g.Z)(f,[["render",d],["__scopeId","data-v-22cb7b90"]]);var v=p},6650:function(t,e,n){n.r(e),n.d(e,{default:function(){return Ct}});var o=n(3396),l=n(7139);const a=t=>((0,o.dD)("data-v-d056375e"),t=t(),(0,o.Cn)(),t),r={class:"order-detail-box"},s=(0,o.Uk)(" 定单详情 "),i={class:"order-status"},c={class:"status-item"},u=a((()=>(0,o._)("label",null,"订单状态：",-1))),d={class:"status-item"},m=a((()=>(0,o._)("label",null,"订单编号：",-1))),f={class:"status-item"},g=a((()=>(0,o._)("label",null,"下单时间：",-1))),p=(0,o.Uk)("去支付"),v=(0,o.Uk)("确认订单"),h={class:"order-price"},w={class:"price-item"},C=a((()=>(0,o._)("label",null,"商品金额：",-1))),k=a((()=>(0,o._)("div",{class:"price-item"},[(0,o._)("label",null,"配送方式："),(0,o._)("span",null,"普通快递")],-1))),b=a((()=>(0,o._)("div",{style:{width:"100%",height:"50px"}},null,-1))),B={style:{width:"90%",margin:"0 auto",padding:"50px 0"}},y=(0,o.Uk)(" 支付宝二维码"),A=a((()=>(0,o._)("br",null,null,-1))),_=(0,o.Uk)(" 微信二维码"),W=a((()=>(0,o._)("br",null,null,-1)));function S(t,e,n,a,S,x){const O=(0,o.up)("nav-bar"),D=(0,o.up)("van-button"),N=(0,o.up)("van-card"),U=(0,o.up)("van-image"),I=(0,o.up)("van-grid-item"),P=(0,o.up)("van-grid"),z=(0,o.up)("van-popup");return(0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(O,{class:"nav-bar"},{default:(0,o.w5)((()=>[s])),_:1}),(0,o._)("div",i,[(0,o._)("div",c,[u,(0,o._)("span",null,(0,l.zw)(a.statusString),1)]),(0,o._)("div",d,[m,(0,o._)("span",null,(0,l.zw)(t.detail.order_no),1)]),(0,o._)("div",f,[g,(0,o._)("span",null,(0,l.zw)(t.detail.created_at),1)]),1==t.detail.status?((0,o.wg)(),(0,o.j4)(D,{key:0,onClick:a.showPayFn,style:{"margin-bottom":"10px"},color:"#1baeae",block:""},{default:(0,o.w5)((()=>[p])),_:1},8,["onClick"])):(0,o.kq)("",!0),2==t.detail.status?((0,o.wg)(),(0,o.j4)(D,{key:1,onClick:a.handleConfirmOrder,block:""},{default:(0,o.w5)((()=>[v])),_:1},8,["onClick"])):(0,o.kq)("",!0)]),(0,o._)("div",h,[(0,o._)("div",w,[C,(0,o._)("span",null,"¥ "+(0,l.zw)(a.total+".00"),1)]),k]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.detail.orderDetails.data,(t=>((0,o.wg)(),(0,o.j4)(N,{key:t.id,num:t.num,price:t.price+".00",desc:"全场包邮",title:t.goods.title,thumb:t.goods.cover_url},null,8,["num","price","title","thumb"])))),128)),b,(0,o.Wm)(z,{show:t.showPay,"onUpdate:show":e[0]||(e[0]=e=>t.showPay=e),position:"bottom",style:{height:"40%"},onClose:a.closeQRcode,closeable:""},{default:(0,o.w5)((()=>[(0,o._)("div",B,[(0,o.Wm)(P,{border:!1,"column-num":2},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{text:"支付宝"},{default:(0,o.w5)((()=>[y,A,(0,o.Wm)(U,{width:"150",height:"150",src:t.aliyun},null,8,["src"])])),_:1}),(0,o.Wm)(I,{text:"微信支付"},{default:(0,o.w5)((()=>[_,W,(0,o.Wm)(U,{width:"150",height:"150",src:t.wechat},null,8,["src"])])),_:1})])),_:1})])])),_:1},8,["show","onClose"])])}n(1958),n(368),n(6742),n(2939),n(1452),n(6196),n(2666);var x=n(4452),O=n(8395),D=n(3296),N=n(4870),U=n(9242),I=n(2981),P=n(5737),z=n(2556),E=n(6300),H=n(1047),Z=n(3603),L=n(9857),Q=n(8455),F=n(1643),R=n(5634);const[T,j]=(0,I["do"])("action-bar"),q=Symbol(T),V={safeAreaInsetBottom:P.J5};var G=(0,o.aZ)({name:T,props:V,setup(t,{slots:e}){const{linkChildren:n}=(0,R.$E)(q);return n(),()=>{var n;return(0,o.Wm)("div",{class:[j(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[null==(n=e.default)?void 0:n.call(e)])}}});const J=(0,O.n)(G);var $=n(998),K=n(1900);const[X,Y]=(0,I["do"])("action-bar-button"),M=(0,x.l7)({},K.g2,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var tt=(0,o.aZ)({name:X,props:M,setup(t,{slots:e}){const n=(0,K.yj)(),{parent:l,index:a}=(0,R.NB)(q),r=(0,o.Fl)((()=>{if(l){const t=l.children[a.value-1];return!(t&&"isButton"in t)}})),s=(0,o.Fl)((()=>{if(l){const t=l.children[a.value+1];return!(t&&"isButton"in t)}}));return(0,$.F)({isButton:!0}),()=>{const{type:l,icon:a,text:i,color:c,loading:u,disabled:d}=t;return(0,o.Wm)(F.z,{class:Y([l,{last:s.value,first:r.value}]),size:"large",type:l,icon:a,color:c,loading:u,disabled:d,onClick:n},{default:()=>[e.default?e.default():i]})}}});const et=(0,O.n)(tt);const[nt,ot,lt]=(0,I["do"])("dialog"),at=(0,x.l7)({},L.W,{title:String,theme:String,width:P.Or,message:[String,Function],callback:Function,allowHtml:Boolean,className:P.Vg,transition:(0,P.SQ)("van-dialog-bounce"),messageAlign:String,closeOnPopstate:P.J5,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showConfirmButton:P.J5,closeOnClickOverlay:Boolean}),rt=[...L.m,"transition","closeOnPopstate"];var st=(0,o.aZ)({name:nt,props:at,emits:["confirm","cancel","keydown","update:show"],setup(t,{emit:e,slots:n}){const l=(0,N.iH)(),a=(0,N.qj)({confirm:!1,cancel:!1}),r=t=>e("update:show",t),s=e=>{var n;r(!1),null==(n=t.callback)||n.call(t,e)},i=n=>()=>{t.show&&(e(n),t.beforeClose?(a[n]=!0,(0,z.I)(t.beforeClose,{args:[n],done(){s(n),a[n]=!1},canceled(){a[n]=!1}})):s(n))},c=i("cancel"),u=i("confirm"),d=(0,U.D2)((n=>{var o,a;if(n.target!==(null==(a=null==(o=l.value)?void 0:o.popupRef)?void 0:a.value))return;const r={Enter:t.showConfirmButton?u:x.ZT,Escape:t.showCancelButton?c:x.ZT};r[n.key](),e("keydown",n)}),["enter","esc"]),m=()=>{const e=n.title?n.title():t.title;if(e)return(0,o.Wm)("div",{class:ot("header",{isolated:!t.message&&!n.default})},[e])},f=e=>{const{message:n,allowHtml:l,messageAlign:a}=t,r=ot("message",{"has-title":e,[a]:a}),s=(0,E.mf)(n)?n():n;return l&&"string"===typeof s?(0,o.Wm)("div",{class:r,innerHTML:s},null):(0,o.Wm)("div",{class:r},[s])},g=()=>{if(n.default)return(0,o.Wm)("div",{class:ot("content")},[n.default()]);const{title:e,message:l,allowHtml:a}=t;if(l){const t=!(!e&&!n.title);return(0,o.Wm)("div",{key:a?1:0,class:ot("content",{isolated:!t})},[f(t)])}},p=()=>(0,o.Wm)("div",{class:[H.k7,ot("footer")]},[t.showCancelButton&&(0,o.Wm)(F.z,{size:"large",text:t.cancelButtonText||lt("cancel"),class:ot("cancel"),style:{color:t.cancelButtonColor},loading:a.cancel,onClick:c},null),t.showConfirmButton&&(0,o.Wm)(F.z,{size:"large",text:t.confirmButtonText||lt("confirm"),class:[ot("confirm"),{[H.a8]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:a.confirm,onClick:u},null)]),v=()=>(0,o.Wm)(J,{class:ot("footer")},{default:()=>[t.showCancelButton&&(0,o.Wm)(et,{type:"warning",text:t.cancelButtonText||lt("cancel"),class:ot("cancel"),color:t.cancelButtonColor,loading:a.cancel,onClick:c},null),t.showConfirmButton&&(0,o.Wm)(et,{type:"danger",text:t.confirmButtonText||lt("confirm"),class:ot("confirm"),color:t.confirmButtonColor,loading:a.confirm,onClick:u},null)]}),h=()=>n.footer?n.footer():"round-button"===t.theme?v():p();return()=>{const{width:e,title:n,theme:a,message:s,className:i}=t;return(0,o.Wm)(Q.G,(0,o.dG)({ref:l,role:"dialog",class:[ot([a]),i],style:{width:(0,Z.Nn)(e)},tabindex:0,"aria-labelledby":n||s,onKeydown:d,"onUpdate:show":r},(0,x.ei)(t,rt)),{default:()=>[m(),g(),h()]})}}});let it;function ct(){const t={setup(){const{state:t,toggle:e}=(0,D.o)();return()=>(0,o.Wm)(st,(0,o.dG)(t,{"onUpdate:show":e}),null)}};({instance:it}=(0,D.H)(t))}function ut(t){return x._f?new Promise(((e,n)=>{it||ct(),it.open((0,x.l7)({},ut.currentOptions,t,{callback:t=>{("confirm"===t?e:n)(t)}}))})):Promise.resolve()}ut.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},ut.currentOptions=(0,x.l7)({},ut.defaultOptions),ut.alert=ut,ut.confirm=t=>ut((0,x.l7)({showCancelButton:!0},t)),ut.close=()=>{it&&it.toggle(!1)},ut.setDefaultOptions=t=>{(0,x.l7)(ut.currentOptions,t)},ut.resetDefaultOptions=()=>{ut.currentOptions=(0,x.l7)({},ut.defaultOptions)},ut.Component=(0,O.n)(st),ut.install=t=>{t.use(ut.Component),t.config.globalProperties.$dialog=ut};var dt=ut,mt=(n(6743),n(4691)),ft=n(920),gt=n(771),pt=n(678),vt={name:"OrderDetail",components:{NavBar:ft.Z},setup(){const t=(0,pt.yj)(),e=(0,pt.tv)(),n=(0,N.qj)({orderNo:"",detail:{orderDetails:{data:[]},status:0},showPay:!1,aliyun:"",wechat:""}),l=()=>{const{id:e}=t.query;n.orderNo=e,(0,gt.dz)(e).then((t=>{n.detail=t.data}))};(0,o.bv)((()=>{mt.Z.loading({message:"加载中...",forbidClick:!0}),l(),mt.Z.clear()}));const a=(0,o.Fl)((()=>{let t=["","已下单","已支付","等待发货","确认收货","已过期"];return t[n.detail.status]})),r=(0,o.Fl)((()=>{let t=0;return n.detail.orderDetails.data.forEach((e=>{t+=e.num*e.price})),t})),s=()=>{n.showPay=!0,(0,gt._r)(n.orderNo,{type:"aliyun"}).then((t=>{n.aliyun=t.data.qr_code_url,n.wechat=t.data.qr_code_url}));const t=setInterval((()=>{(0,gt.LX)(n.orderNo).then((o=>{"2"==o.data&&(clearInterval(t),n.showPay=!1,e.push({path:"/orderdetail",query:{id:n.orderNo}}))}))}),2e3)},i=()=>{dt.confirm({title:"是否确认订单"}).then((()=>{(0,gt.Nc)(n.orderNo).then((t=>{(0,mt.Z)("确认成功"),l()}))})).catch((()=>{}))},c=()=>{dt.close()},u=()=>{n.detail.status=2};return{...(0,N.BK)(n),statusString:a,total:r,showPayFn:s,handleConfirmOrder:i,close:c,closeQRcode:u}}},ht=n(89);const wt=(0,ht.Z)(vt,[["render",S],["__scopeId","data-v-d056375e"]]);var Ct=wt},2291:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABk0lEQVRoQ+2Z3UYFURSA1/c8dVcv0H23iYiIiIiIiH5ERMQhIiIi0kPUfd3Vk/QAO5s5HJmzW2f/tbZm7saZGd+31p519lqDNH7QOL8MAn+dwSED/y4DzrkTEVkWkS8ReQX8efRRdQl18McTtJ/AfDS9SL0q1APvud+BRfMCU+A996n5JRSAPwLOUqLv7y36DgTgD4HzVPiiAgH4A+AiB3wxgQD8PnCZC76IgHPOl8m+2r4HXOWEzy4QgN8FRrnhswoE4HeA6xLw2QQC8NvATSn4LAIB+C3gtiR8skCg2mwCd6XhkwQC8BvAfQ34aIEA/DrwUAs+SiAAvwY81oSPFfgQkbkfoKvAU234WIE3EVloWcBvEya7qrFLG0vI0zb9Eo/D3XQZVUjY/yNTSNjfSigk7G/mFBL2t9MKCfsNjULCfkupkLDf1Csk7I9VFBL2B1sKCfujRYWE/eHuLxLtfB+Ysot9AZZSGqGi0+k+sG4Ms9L99mz++0BKdDX3Vs+ABmqWawaBWaJV4tohAyWiOsszvwGAjbUxED2S5gAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=650.b8f01a19.js.map