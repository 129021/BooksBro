{"version":3,"file":"js/271.5bd8da9f.js","mappings":"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","sources":["webpack://my_vue3_project/./src/views/category/Category.vue","webpack://my_vue3_project/./src/network/category.js","webpack://my_vue3_project/./src/views/category/Category.vue?89fc"],"sourcesContent":["<template>\r\n  <nav-bar>\r\n    <template v-slot:default> 商品分类 </template>\r\n  </nav-bar>\r\n\r\n  <div id=\"mainbox\">\r\n    <div class=\"ordertab\">\r\n      <van-tabs v-model:active=\"act\" @click=\"onClickTab\">\r\n        <van-tab title=\"销量排序\"></van-tab>\r\n        <van-tab title=\"价格排序\"></van-tab>\r\n        <van-tab title=\"评论排序\"></van-tab>\r\n      </van-tabs>\r\n    </div>\r\n\r\n    <van-sidebar v-model=\"active\" class=\"leftmenu\">\r\n      <van-collapse v-model=\"activeName\" accordion>\r\n        <van-collapse-item\r\n          v-for=\"(item, index) in categories\"\r\n          key=\"item.id\"\r\n          :title=\"item.name\"\r\n          :name=\"item.name\"\r\n        >\r\n          <van-sidebar-item\r\n            v-for=\"child in item.children\"\r\n            :key=\"child.id\"\r\n            :title=\"child.name\"\r\n            @click=\"getGoods(child.id)\"\r\n          />\r\n        </van-collapse-item>\r\n      </van-collapse>\r\n    </van-sidebar>\r\n\r\n    <div class=\"goodslist\">\r\n      <div class=\"content\">\r\n        <van-card\r\n          :num=\"item.comments_count\"\r\n          :tag=\"item.comments_count > 0 ? '热卖' : '新品'\"\r\n          :price=\"item.price\"\r\n          :desc=\"item.updated_at\"\r\n          :title=\"item.title\"\r\n          :thumb=\"item.cover_url\"\r\n          :lazy-load=\"true\"\r\n          v-for=\"item in showGoods\"\r\n          :key=\"item.id\"\r\n          @click=\"itemClick(item.id)\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <back-top v-show=\"isTabFixed\" @bTop=\"bTop\"></back-top>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from \"components/common/navbar/NavBar\";\r\nimport { ref, reactive, onMounted, computed, watchEffect, nextTick } from \"vue\";\r\n\r\nimport { getCategory, getCategoryGoods } from \"network/category.js\";\r\n\r\nimport BScroll from \"better-scroll\";\r\n\r\nimport BackTop from \"components/common/backtop/BackTop\";\r\n\r\nimport { useRouter } from \"vue-router\";\r\nexport default {\r\n  name: \"Category\",\r\n  components: {\r\n    NavBar,\r\n    BackTop,\r\n  },\r\n\r\n  setup() {\r\n    let active = ref(0);\r\n    let categories = ref([]);\r\n    let activeName = ref(1);\r\n    let act = ref(1);\r\n    let currentId = ref(0);\r\n\r\n    let currentOrder = ref(\"sales\");\r\n\r\n    let bs = reactive({});\r\n\r\n    // 显示返回按钮的变量\r\n    let isTabFixed = ref(false);\r\n\r\n    const router = useRouter();\r\n\r\n    const goods = reactive({\r\n      sales: { page: 1, list: [] },\r\n      price: { page: 1, list: [] },\r\n      comments_count: { page: 1, list: [] },\r\n    });\r\n\r\n    // 显示的goodslist\r\n    const showGoods = computed(() => {\r\n      return goods[currentOrder.value].list;\r\n    });\r\n\r\n    const init = () => {\r\n      getCategoryGoods(\"sales\", currentId.value).then((res) => {\r\n        console.log(res);\r\n        goods.sales.list = res.data.goods.data;\r\n      });\r\n\r\n      getCategoryGoods(\"price\", currentId.value).then((res) => {\r\n        // console.log(res);\r\n        goods.price.list = res.data.goods.data;\r\n      });\r\n\r\n      getCategoryGoods(\"comments_count\", currentId.value).then((res) => {\r\n        // console.log(res);\r\n        goods.comments_count.list = res.data.goods.data;\r\n      });\r\n    };\r\n\r\n    onMounted(() => {\r\n      getCategory().then((res) => {\r\n        // console.log(res);\r\n        categories.value = res.data.categories;\r\n      });\r\n\r\n      init();\r\n\r\n      bs = new BScroll(document.querySelector(\".goodslist\"), {\r\n        probeType: 3, //0,1,2,3只要在运动就触发scroll事件\r\n        click: true,\r\n        pullUpLoad: true, //上拉加载更多\r\n      });\r\n\r\n      // 注册滚动事件\r\n      bs.on(\"scroll\", (position) => {\r\n        // console.log('banner+recommend的高度是：'+banref.value.offsetHeight);\r\n        // console.log(position.y);\r\n\r\n        // isTabFixed.value,一定不能忘了value\r\n        isTabFixed.value = -position.y > 300;\r\n      });\r\n\r\n      // 上拉加载更多\r\n      bs.on(\"pullingUp\", () => {\r\n        console.log(\"上拉加载更多...\");\r\n\r\n        const page = goods[currentOrder.value].page + 1;\r\n\r\n        getCategoryGoods(currentOrder.value, currentId.value).then((res) => {\r\n          // console.log(res);\r\n          goods[currentOrder.value].list.push(...res.data.goods.data);\r\n          goods[currentOrder.value].page += 1;\r\n\r\n          bs && bs.refresh();\r\n        });\r\n        // console.log(document.querySelector(\"content\").clientHeight);\r\n\r\n        // 完成上拉，等数据请求完成，要将数据展示出来\r\n        bs.finishPullUp();\r\n        bs.refresh();\r\n      });\r\n    });\r\n\r\n    // 排序选项卡\r\n    const onClickTab = (index) => {\r\n      let orders = [\"sales\", \"price\", \"comments_count\"];\r\n      console.log(\"排序的序号：\" + orders[index]);\r\n      currentOrder.value = orders[index];\r\n\r\n      getCategoryGoods(currentOrder.value, currentId.value).then((res) => {\r\n        // console.log(res);\r\n        goods[currentOrder.value].list = res.data.goods.data;\r\n\r\n        bs && bs.refresh();\r\n      });\r\n    };\r\n\r\n    // 通过分类得到get商品\r\n\r\n    const getGoods = (cid) => {\r\n      currentId.value = cid;\r\n      // console.log(cid);\r\n      console.log(currentId.value);\r\n      // init();\r\n      getCategoryGoods(currentOrder.value, currentId.value).then((res) => {\r\n        // console.log(res);\r\n        goods[currentOrder.value].list = res.data.goods.data;\r\n      });\r\n\r\n      bs && bs.refresh();\r\n    };\r\n\r\n    // 监听：任何一个变量有变化\r\n    watchEffect(() => {\r\n      nextTick(() => {\r\n        // 重新计算高度\r\n        bs && bs.refresh();\r\n      });\r\n    });\r\n\r\n    const bTop = () => {\r\n      // console.log('click to top');\r\n      bs.scrollTo(0, 0, 500);\r\n    };\r\n    const itemClick = (id) => {\r\n      router.push({ path: \"/detail\", query: { id } });\r\n    };\r\n\r\n    return {\r\n      active,\r\n      categories,\r\n      activeName,\r\n      act,\r\n      onClickTab,\r\n      currentOrder,\r\n      getGoods,\r\n      currentId,\r\n      goods,\r\n      showGoods,\r\n      init,\r\n      bs,\r\n      isTabFixed,\r\n      bTop,\r\n      itemClick,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n<style scoped >\r\n#mainbox {\r\n  display: flex;\r\n  margin-top: 45px;\r\n}\r\n\r\n.ordertab {\r\n  height: 50px;\r\n  position: fixed;\r\n  top: 45px;\r\n  left: 130px;\r\n  right: 0;\r\n  z-index: 1000;\r\n}\r\n\r\n.leftmenu {\r\n  width: 130px;\r\n\r\n  background-color: green;\r\n  position: fixed;\r\n  top: 95px;\r\n}\r\n\r\n.goodslist {\r\n  flex: 1;\r\n  position: absolute;\r\n  top: 94px;\r\n  left: 130px;\r\n  right: 0;\r\n  height: 100vh;\r\n  padding: 0 10px;\r\n}\r\n</style>\r\n\r\n<style >\r\n.van-card__content {\r\n  text-align: left;\r\n}\r\n\r\n.van-card__thumb {\r\n  width: 68px;\r\n}\r\n\r\n.van-image {\r\n  width: 68px;\r\n}\r\n.van-image__img {\r\n  width: 68px;\r\n}\r\n</style>","import {\r\n    request\r\n} from './request';\r\n\r\nexport function getCategory() {\r\n    return request({\r\n        url:'/api/goods',\r\n\r\n    })\r\n}\r\n\r\nexport function getCategoryGoods(order='sales',cid=0,page=1){\r\n    return request({\r\n        url:'/api/goods?category_id='+cid+'&page='+page+'&'+order+'=1',\r\n    })\r\n}","import { render } from \"./Category.vue?vue&type=template&id=318486f0&scoped=true\"\nimport script from \"./Category.vue?vue&type=script&lang=js\"\nexport * from \"./Category.vue?vue&type=script&lang=js\"\n\nimport \"./Category.vue?vue&type=style&index=0&id=318486f0&scoped=true&lang=css\"\nimport \"./Category.vue?vue&type=style&index=1&id=318486f0&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\wangj\\\\Desktop\\\\vue3_project\\\\my_vue3_project-master\\\\BooksBro\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-318486f0\"]])\n\nexport default __exports__"],"names":["id","class","_createVNode","_component_nav_bar","default","_createElementVNode","_component_van_tabs","active","$setup","$event","onClick","_component_van_tab","title","_component_van_sidebar","_component_van_collapse","accordion","_createElementBlock","_Fragment","_renderList","item","index","_createBlock","_component_van_collapse_item","key","name","children","child","_component_van_sidebar_item","_component_van_card","num","comments_count","tag","price","desc","updated_at","thumb","cover_url","_component_back_top","onBTop","getCategory","request","url","getCategoryGoods","order","cid","page","components","NavBar","BackTop","setup","ref","categories","activeName","act","currentId","currentOrder","bs","reactive","isTabFixed","router","useRouter","goods","sales","list","showGoods","computed","value","init","then","res","console","log","data","onMounted","BScroll","document","querySelector","probeType","click","pullUpLoad","on","position","y","push","refresh","finishPullUp","onClickTab","orders","getGoods","watchEffect","nextTick","bTop","scrollTo","itemClick","path","query","__exports__","render"],"sourceRoot":""}